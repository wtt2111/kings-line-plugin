# King's Line - ゲーム設計書

## 概要

| 項目 | 内容 |
|------|------|
| バージョン | Minecraft 1.8.8 |
| 形式 | 2チーム対戦型 PvP |
| プレイ時間 | 15〜30分 |
| プレイヤー数 | 最低 3v3 / 推奨 4v4〜20v20 |

---

## コアコンセプト

### ポイントレース
- キル / 中央エリア占領 / コア破壊 / キング関連でポイント獲得
- 敵に **500ポイント取られたチーム**はリスポーン不可になる
- リスポーン不可チームが全滅したら試合終了

### 通貨システム
| 通貨 | 入手方法 | 死亡時 | 用途 |
|------|----------|--------|------|
| **Shard** | フィールドで拾う | ドロップ（敵に奪われる） | チーム共同アップグレード |
| **Lumina** | キル時に入手 | ドロップ（敵に奪われる） | 個人ショップ |

- 両通貨とも **拠点（スポーン付近）に戻ると自動貯金**
- 貯金済み通貨は死亡しても失われない

### キング & エレメント
- 各チームに1人 **キング** を選出（HP2倍、防御バフ、速度オーラ）
- キングが死ぬと大きくポイントが動き、敵全員が一時強化
- 各プレイヤーは **Fire / Ice / Wind / Earth** から1つ選択
- 敵に10ヒットで **SPゲージ** が溜まり、エレメント固有のスペシャル技が発動可能

---

## スコアシステム

### ポイント獲得
| アクション | ポイント |
|------------|----------|
| 通常キル | +4pt |
| キングキル | +20pt |
| キング死亡ペナルティ（倒された側） | -50pt |
| コア破壊 | +100pt |
| Bエリア占領（tick毎、人数優位時） | +2pt |

### 500pt到達時
1. 相手チームのリスポーンが無効化
2. 以降、そのチームが全滅したら試合終了

---

## 通貨詳細

### Shard（チームアップグレード用）

**状態管理:**
| 状態 | 説明 |
|------|------|
| 所持中 | フィールドで拾った未保護のShard |
| 貯金済み | 拠点に戻ると自動で保護される |

**入手源:**
- A/B/Cエリアの定期スポーン（10秒ごと）
- コア破壊時ドロップ（20個）
- キング死亡時ドロップ（5個）

**死亡時:**
- 所持中Shardを全てその場にドロップ
- 敵が拾って持ち帰れば横取り可能

**使い道:**
- チームアップグレードに投資（複数人で協力）

### Lumina（個人ショップ用）

**入手源:**
- キル時に +2 Lumina

**死亡時:**
- 所持中Luminaを全てその場にドロップ
- 敵が拾える

**使い道:**
- 個人ショップでアイテム購入

---

## チームアップグレード

複数人が貯金Shardを投資し、目標額に達したらチーム全員にアップグレードが適用される。

### アップグレード一覧
| カテゴリ | Tier 0 | Tier 1 | Tier 2 | Tier 3 | 必要Shard |
|----------|--------|--------|--------|--------|-----------|
| **防具** | 皮装備 | 鉄装備 | ダイヤ装備 | - | 0 / 100 / 250 |
| **武器** | 木の剣 | 石の剣 | 鉄の剣 | ダイヤの剣 | 0 / 50 / 120 / 250 |
| **プロテクション** | なし | I | II | III | 0 / 80 / 160 / 300 |
| **シャープネス** | なし | I | II | III | 0 / 80 / 160 / 300 |
| **生命力強化** | なし | HP +2 | HP +4 | - | 0 / 150 / 350 |
| **俊足** | なし | 速度+10% | 速度+20% | - | 0 / 120 / 280 |

### 投資の仕組み
1. NPCに話しかけてアップグレードGUIを開く
2. アップグレードを選択
3. 貯金Shardから投資額を選択（1 / 10 / 50 / 全額）
4. 複数人の投資額が目標に達したら自動でアップグレード完了

---

## 個人ショップ（Lumina消費）

NPCに話しかけてショップGUIを開く。

### 消耗品
| アイテム | 価格 | 効果 |
|----------|------|------|
| 金のリンゴ | 8 | 回復 + 吸収効果 |
| 治癒のスプラッシュ | 5 | 即座にHP回復 |
| スピード II (30秒) | 6 | 移動速度UP |
| 跳躍 II (30秒) | 4 | ジャンプ力UP |
| 牛乳 | 3 | デバフ解除 |
| ステーキ x5 | 2 | 満腹度回復 |

### 武器・ツール
| アイテム | 価格 | 効果 |
|----------|------|------|
| 弓 | 10 | 遠距離攻撃 |
| 矢 x16 | 4 | 弓の弾薬 |
| 火矢 x8 | 8 | 当たると炎上 |
| 毒矢 x8 | 10 | 当たると毒II (3秒) |
| 鉄の剣 (早期購入) | 25 | アップグレード前に入手可能 |
| 鉄装備セット | 40 | 早期入手用 |

### 特殊アイテム
| アイテム | 価格 | 効果 |
|----------|------|------|
| エンダーパール | 15 | テレポート（落下ダメあり） |
| ゴーストオーブ | 20 | 5秒間透明+無敵、攻撃不可 |
| フラッシュバン x3 | 6 | 投げて当たると盲目3秒 |
| グラップル | 12 | 3回使用可、引っ張り移動 |
| ファイアチャージ x3 | 10 | 小さな火の玉を投射 |
| シールドトーテム | 25 | 次の一撃を完全無効化 |
| デスマーク | 10 | 次に攻撃した敵の位置を30秒共有 |

---

## コアシステム

各チームの拠点に **黒曜石のコア** が存在。

### 破壊時
- 破壊チームに +100pt
- その場にShard 20個ドロップ
- 全プレイヤーにTitle通知 + 爆発サウンド

### 再生成
- **5秒後に同じ位置に黒曜石が再生成**
- 再生成時に全プレイヤーに通知

### 接近警告
- 敵プレイヤーがコアから **10ブロック以内** に入ったら警告
- 該当チーム全員に：
  - ボスバーで警告表示
  - サウンド再生
  - チャットメッセージ

---

## キングシステム

### 選出方法
1. 準備フェーズ中にチャットで `!king` と発言で立候補
2. 立候補者がいればその中から選出（複数の場合は最初の1人）
3. 立候補者がいなければランダム選出

### キングのステータス
- **HP:** Health Boost II（通常の2倍）
- **防御:** Damage Resistance I
- **オーラ:** 半径8ブロック以内の味方に Speed I

### キング死亡時
1. 倒された側: -50pt
2. 倒した側: +20pt（キングキル）
3. 敵チーム全員に15秒間 Strength I
4. キングの死亡位置にShard 5個ドロップ
5. 同チームの生存者から新しいキングを自動選出

---

## エレメント（キット）

試合開始前に選択。試合中は変更不可。

### SPゲージ
- 敵プレイヤーへの攻撃1ヒット = +1ゲージ
- **10ヒットでゲージMAX** → スペシャル技使用可能
- 使用後はゲージ0 + クールダウン15秒

### 🔥 Fire
| 種別 | 効果 |
|------|------|
| パッシブ | 与ダメ+7%、10%で炎上、被ダメ+5% |
| SP技「Overheat」 | 5秒間：与ダメ+20%、必ず炎上、被ダメ+10% |

### ❄ Ice
| 種別 | 効果 |
|------|------|
| パッシブ | エリア内でノックバック-20%、20%で相手Slow、移動-5% |
| SP技「Ice Age」 | 半径6ブロック内の敵2人を1.5秒間足止め |

### 🌪 Wind
| 種別 | 効果 |
|------|------|
| パッシブ | 常時Speed I + Jump Boost I、被ダメ+10% |
| SP技「Gale Step」 | 視線先の敵の背後に瞬間移動、4秒間Speed II |

### 🪨 Earth
| 種別 | 効果 |
|------|------|
| パッシブ | 被ダメ-10%、ノックバック-30%、移動-5% |
| SP技「Bulwark」 | 5秒間：被ダメ-20%、ノックバック半減、移動-20% |

---

## UI表示

### サイドバースコアボード
常時表示される情報：
- 両チームのポイント
- コア状態（破壊/正常）
- 個人の所持Shard/Lumina
- 個人の貯金Shard/Lumina
- K/D

### ボスバー
- 通常時：両チームのポイント比率
- コア破壊時：「○○のコアが破壊されています！」
- コア警告時：「⚠ コアに敵が接近中！」

### アクションバー
- エリア制圧中：「Bエリア制圧中！ +2pt/tick」
- Shard拾得：「◈+1 (所持: 3)」
- 拠点到着：「✓ 貯金完了！ ◈3 ✦5」
- キル時：「+4pt ✦+2」

---

## ゲームフロー

### 1. 待機状態 (WAITING)
- `/kl start` でゲーム開始

### 2. 準備フェーズ (STARTING) - 約45秒
1. チーム振り分け（パーティー考慮）
2. Title表示：「⚔ KING'S LINE ⚔」
3. ネザースター配布（右クリックでエレメント選択GUI）
4. `!king` でキング立候補
5. 各チームスポーンへテレポート

### 3. 本戦 (RUNNING)
- PvP有効
- Shardスポーン開始
- エリア占領判定開始
- NPCによるショップ/アップグレード

### 4. 終了 (ENDING)
- 勝利チーム発表（Title表示）
- 統計保存
- ロビーへテレポート

---

## マップスケール

| モード | 人数 | 使用エリア |
|--------|------|------------|
| 小規模 | 〜4v4 | Bのみ |
| 大規模 | 5v5〜 | A / B / C |

- **Bエリア:** ポイント獲得 + Shardスポーン
- **A/Cエリア:** Shardスポーンのみ（ポイントなし）
