# King's Line - ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼

## å…¨ä½“ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   WAITING   â”‚  ã‚µãƒ¼ãƒãƒ¼èµ·å‹•å¾Œã®å¾…æ©ŸçŠ¶æ…‹
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ /kl start
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STARTING   â”‚  æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º (30-60ç§’)
â”‚             â”‚  - ãƒãƒ¼ãƒ æŒ¯ã‚Šåˆ†ã‘
â”‚             â”‚  - ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆé¸æŠ
â”‚             â”‚  - ã‚­ãƒ³ã‚°æŠ•ç¥¨
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ æº–å‚™å®Œäº†
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RUNNING   â”‚  æœ¬æˆ¦
â”‚             â”‚  - PvPæœ‰åŠ¹
â”‚             â”‚  - ã‚¨ãƒªã‚¢åˆ¶åœ§
â”‚             â”‚  - Shard/Luminaåé›†
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 500ptåˆ°é” â†’ å…¨æ»…
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ENDING    â”‚  çµ‚äº†å‡¦ç†
â”‚             â”‚  - å‹è€…ç™ºè¡¨
â”‚             â”‚  - çµ±è¨ˆè¡¨ç¤º
â”‚             â”‚  - ãƒ¯ãƒ¼ãƒ«ãƒ‰ãƒªã‚»ãƒƒãƒˆ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 1: WAITING (å¾…æ©Ÿ)

### çŠ¶æ…‹
- ã‚²ãƒ¼ãƒ ãŒé–‹å§‹ã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹
- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã‚µãƒ¼ãƒãƒ¼ã«è‡ªç”±ã«å‡ºå…¥ã‚Šå¯èƒ½

### ãƒˆãƒªã‚¬ãƒ¼
- `/kl start` ã‚³ãƒãƒ³ãƒ‰ã§ STARTING ã¸é·ç§»

---

## Phase 2: STARTING (æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º)

### æ™‚é–“
- 30ã€œ60ç§’ (config.ymlã§è¨­å®šå¯èƒ½)

### å‡¦ç†é †åº

#### 1. ãƒãƒ¼ãƒ æŒ¯ã‚Šåˆ†ã‘
```
1. ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
2. ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã”ã¨ã«ãƒ©ãƒ³ãƒ€ãƒ ã§ãƒãƒ¼ãƒ ã‚’å‰²ã‚Šå½“ã¦
3. ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã«å±ã•ãªã„ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ãƒãƒ©ãƒ³ã‚¹èª¿æ•´ã—ãªãŒã‚‰å‰²ã‚Šå½“ã¦
```

#### 2. ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆé¸æŠ
- å…¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã€Œã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆé¸æŠã‚¢ã‚¤ãƒ†ãƒ ã€ã‚’é…å¸ƒ
- å³ã‚¯ãƒªãƒƒã‚¯ã§GUIã‚’é–‹ãã€Fire/Ice/Wind/Earthã‹ã‚‰é¸æŠ
- æ™‚é–“å†…ã«é¸æŠã—ãªã„å ´åˆã¯ãƒ©ãƒ³ãƒ€ãƒ 

#### 3. ã‚­ãƒ³ã‚°æŠ•ç¥¨
```
1. ç«‹å€™è£œå—ä»˜ (15ç§’)
   - ãƒãƒ£ãƒƒãƒˆã§ã€Œ!kingã€ã¨ç™ºè¨€ã§ç«‹å€™è£œ
   
2. æŠ•ç¥¨ (15ç§’)
   - ç«‹å€™è£œè€…ãŒã„ã‚Œã°GUIã§æŠ•ç¥¨
   - æœ€å¤šç¥¨ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚­ãƒ³ã‚°ã«æ±ºå®š
   
3. ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
   - ç«‹å€™è£œè€…0äºº â†’ ãƒ©ãƒ³ãƒ€ãƒ  or æœ€é«˜ã‚¹ã‚¿ãƒƒãƒ„
   - åŒç¥¨ â†’ ãƒ©ãƒ³ãƒ€ãƒ 
```

#### 4. åˆæœŸè£…å‚™é…å¸ƒ
- çš®ãƒ•ãƒ«ã‚»ãƒƒãƒˆ
- çŸ³ã®å‰£
- é£Ÿæ–™ (ã‚¹ãƒ†ãƒ¼ã‚­16å€‹ãªã©)
- ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆé¸æŠã‚¢ã‚¤ãƒ†ãƒ ã¯å›å

#### 5. ãƒ†ãƒ¬ãƒãƒ¼ãƒˆ
- å„ãƒãƒ¼ãƒ ã®ã‚¹ãƒãƒ¼ãƒ³åœ°ç‚¹ã¸ãƒ†ãƒ¬ãƒãƒ¼ãƒˆ
- ãƒãƒªã‚¢çŠ¶æ…‹ (ç§»å‹•ä¸å¯ or é€æ˜å£)

---

## Phase 3: RUNNING (æœ¬æˆ¦)

### é–‹å§‹æ™‚
- ãƒãƒªã‚¢è§£é™¤
- å…¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«é–‹å§‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- BGMå†ç”Ÿ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

### ç¶™ç¶šå‡¦ç† (ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—)

#### 3ç§’ã”ã¨: ã‚¨ãƒªã‚¢å é ˜åˆ¤å®š
```java
// Bã‚¨ãƒªã‚¢å é ˜ãƒã‚¤ãƒ³ãƒˆ
int blueCount = areaB.getPlayersInside(Team.BLUE).size();
int redCount = areaB.getPlayersInside(Team.RED).size();

if (blueCount > redCount) {
    scoreManager.addPoints(Team.BLUE, 2);
} else if (redCount > blueCount) {
    scoreManager.addPoints(Team.RED, 2);
}
// åŒæ•°ã¯ä½•ã‚‚ãªã—
```

#### 10ç§’ã”ã¨: Shardã‚¹ãƒãƒ¼ãƒ³
```java
// A, B, Cã‚¨ãƒªã‚¢ã®æŒ‡å®šåº§æ¨™ã«Shardã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ‰ãƒ­ãƒƒãƒ—
shardManager.spawnShard(areaA.getSpawnPoint());
shardManager.spawnShard(areaB.getSpawnPoint());
shardManager.spawnShard(areaC.getSpawnPoint());
```

#### 1ç§’ã”ã¨: ã‚­ãƒ³ã‚°ã‚ªãƒ¼ãƒ©
```java
// ã‚­ãƒ³ã‚°ã®å‘¨å›²8ãƒ–ãƒ­ãƒƒã‚¯ã®å‘³æ–¹ã«Speed I
for (KLPlayer klp : getTeamPlayers(king.getTeam())) {
    if (klp.getLocation().distance(king.getLocation()) <= 8) {
        klp.addPotionEffect(new PotionEffect(SPEED, 40, 0));
    }
}
```

### ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†

#### ã‚­ãƒ«ç™ºç”Ÿæ™‚
```java
// ãƒã‚¤ãƒ³ãƒˆåŠ ç®—
if (victim.isKing()) {
    scoreManager.addPoints(killer.getTeam(), 20);      // ã‚­ãƒ³ã‚°ã‚­ãƒ«
    scoreManager.addPoints(victim.getTeam(), -50);     // ãƒšãƒŠãƒ«ãƒ†ã‚£
    // æ•µå…¨å“¡ã«Strength 15ç§’
    // Shard 5å€‹ãƒ‰ãƒ­ãƒƒãƒ—
} else {
    scoreManager.addPoints(killer.getTeam(), 4);       // é€šå¸¸ã‚­ãƒ«
}

// LuminaåŠ ç®—
luminaManager.addLumina(killer, 2);

// SPã‚²ãƒ¼ã‚¸ (ã‚­ãƒ©ãƒ¼ãŒä¸ãˆãŸãƒ’ãƒƒãƒˆæ•°ã§ã‚«ã‚¦ãƒ³ãƒˆæ¸ˆã¿)
```

#### Shardæ‹¾å¾—æ™‚
```java
// ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã«è¿½åŠ  (æœªç¢ºå®šçŠ¶æ…‹)
klPlayer.addShardCarrying(1);
player.sendMessage("Shard ã‚’æ‹¾ã„ã¾ã—ãŸï¼æ‹ ç‚¹ã«æŒã¡å¸°ã£ã¦ãã ã•ã„ã€‚");
```

#### ShardéŠ€è¡Œ (NPCå³ã‚¯ãƒªãƒƒã‚¯)
```java
int carrying = klPlayer.getShardCarrying();
if (carrying > 0) {
    teamManager.addTeamShard(klPlayer.getTeam(), carrying);
    klPlayer.setShardCarrying(0);
    player.sendMessage(carrying + " Shard ã‚’ãƒãƒ¼ãƒ ã«ç´ã‚ã¾ã—ãŸï¼");
}
```

#### æ­»äº¡æ™‚
```java
// æ‰€æŒShardã‚’ãƒ‰ãƒ­ãƒƒãƒ—
if (klPlayer.getShardCarrying() > 0) {
    shardManager.dropShard(deathLocation, klPlayer.getShardCarrying());
    klPlayer.setShardCarrying(0);
}

// ãƒªã‚¹ãƒãƒ¼ãƒ³å¯èƒ½ã‹ç¢ºèª
if (klPlayer.canRespawn()) {
    // 5ç§’å¾Œã«ãƒªã‚¹ãƒãƒ¼ãƒ³
    scheduleRespawn(klPlayer, 5);
} else {
    // è¦³æˆ¦ãƒ¢ãƒ¼ãƒ‰ã¸
    setSpectator(klPlayer);
}
```

### 500ptåˆ°é”æ™‚
```java
Team winner = scoreManager.getLeadingTeam();
Team loser = winner.getOpposite();

// æ•—åŒ—ãƒãƒ¼ãƒ ã®ãƒªã‚¹ãƒãƒ¼ãƒ³ç„¡åŠ¹åŒ–
for (KLPlayer klp : getTeamPlayers(loser)) {
    klp.setCanRespawn(false);
}

broadcast("Â§c" + loser.getName() + "ãƒãƒ¼ãƒ ã®ãƒªã‚¹ãƒãƒ¼ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¾ã—ãŸï¼");
```

---

## Phase 4: ENDING (çµ‚äº†)

### ãƒˆãƒªã‚¬ãƒ¼
- ãƒªã‚¹ãƒãƒ¼ãƒ³ç„¡åŠ¹åŒ–å¾Œã€ç‰‡æ–¹ã®ãƒãƒ¼ãƒ ãŒå…¨æ»…

### å‡¦ç†

#### 1. ã‚²ãƒ¼ãƒ åœæ­¢
- PvPç„¡åŠ¹åŒ–
- å…¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å‹•ã‘ãªãã™ã‚‹ (ãƒ•ãƒªãƒ¼ã‚º)

#### 2. çµæœç™ºè¡¨ (5ç§’é–“)
```
=====================================
        ğŸ† BLUE TEAM WINS! ğŸ†
=====================================
  Final Score: BLUE 523 - RED 500
  
  MVP: PlayerName (12 Kills)
  
  King Kills: 2
  Core Destroyed: Yes
=====================================
```

#### 3. çµ±è¨ˆä¿å­˜
```java
for (KLPlayer klp : getAllPlayers()) {
    database.addKills(klp.getUuid(), klp.getKillsThisGame());
    database.addDeaths(klp.getUuid(), klp.getDeathsThisGame());
    if (klp.getTeam() == winnerTeam) {
        database.addWin(klp.getUuid());
    }
}
```

#### 4. ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- å…¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ãƒ­ãƒ“ãƒ¼ã¸ãƒ†ãƒ¬ãƒãƒ¼ãƒˆ (è¨­å®šã•ã‚Œã¦ã„ã‚Œã°)
- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ
- ã‚¢ãƒªãƒ¼ãƒŠãƒªã‚»ãƒƒãƒˆ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)
- GameState â†’ WAITING

---

## ã‚¹ã‚±ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆ

### åˆ¤å®šã‚¿ã‚¤ãƒŸãƒ³ã‚°
- STARTING ãƒ•ã‚§ãƒ¼ã‚ºé–‹å§‹æ™‚

### ãƒ«ãƒ¼ãƒ«
```java
int totalPlayers = getPlayerCount();
int perTeam = totalPlayers / 2;

if (perTeam <= 4) {
    // å°è¦æ¨¡ãƒ¢ãƒ¼ãƒ‰: Bã‚¨ãƒªã‚¢ã®ã¿
    areaA.setEnabled(false);
    areaC.setEnabled(false);
} else {
    // ä¸­ã€œå¤§è¦æ¨¡ãƒ¢ãƒ¼ãƒ‰: A/B/Cå…¨ã¦
    areaA.setEnabled(true);
    areaC.setEnabled(true);
}
```
