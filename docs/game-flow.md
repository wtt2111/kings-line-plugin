# King's Line - ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼

## å…¨ä½“ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   WAITING   â”‚  ã‚µãƒ¼ãƒãƒ¼èµ·å‹•å¾Œã®å¾…æ©ŸçŠ¶æ…‹
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ /kl start
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STARTING   â”‚  æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º (ç´„45ç§’)
â”‚             â”‚  - ãƒãƒ¼ãƒ æŒ¯ã‚Šåˆ†ã‘
â”‚             â”‚  - Titleè¡¨ç¤º
â”‚             â”‚  - ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆé¸æŠ
â”‚             â”‚  - ã‚­ãƒ³ã‚°æŠ•ç¥¨
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ æº–å‚™å®Œäº†
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RUNNING   â”‚  æœ¬æˆ¦
â”‚             â”‚  - PvPæœ‰åŠ¹
â”‚             â”‚  - ã‚¨ãƒªã‚¢åˆ¶åœ§
â”‚             â”‚  - Shard/Luminaåé›†
â”‚             â”‚  - ã‚³ã‚¢æ”»é˜²
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ 500ptåˆ°é” â†’ å…¨æ»…
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ENDING    â”‚  çµ‚äº†å‡¦ç†
â”‚             â”‚  - å‹è€…ç™ºè¡¨
â”‚             â”‚  - çµ±è¨ˆä¿å­˜
â”‚             â”‚  - ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 1: WAITING (å¾…æ©Ÿ)

### çŠ¶æ…‹
- ã‚²ãƒ¼ãƒ ãŒé–‹å§‹ã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹
- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã‚µãƒ¼ãƒãƒ¼ã«è‡ªç”±ã«å‡ºå…¥ã‚Šå¯èƒ½

### ãƒˆãƒªã‚¬ãƒ¼
- `/kl start` ã‚³ãƒãƒ³ãƒ‰ã§ STARTING ã¸é·ç§»

---

## Phase 2: STARTING (æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º)

### æ™‚é–“
- ç´„45ç§’ï¼ˆã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆé¸æŠ30ç§’ + ã‚­ãƒ³ã‚°æŠ•ç¥¨15ç§’ï¼‰

### å‡¦ç†é †åº

#### 1. ãƒãƒ¼ãƒ æŒ¯ã‚Šåˆ†ã‘
```
1. ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
2. ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã”ã¨ã«ãƒ©ãƒ³ãƒ€ãƒ ã§ãƒãƒ¼ãƒ ã‚’å‰²ã‚Šå½“ã¦
3. ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã«å±ã•ãªã„ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ãƒãƒ©ãƒ³ã‚¹èª¿æ•´ã—ãªãŒã‚‰å‰²ã‚Šå½“ã¦
```

#### 2. Titleè¡¨ç¤º
å…¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å¤§ããè¡¨ç¤ºï¼š
```
âš” KING'S LINE âš”
æº–å‚™ãƒ•ã‚§ãƒ¼ã‚ºé–‹å§‹ï¼
```

#### 3. ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆé¸æŠ
- **ãƒã‚¶ãƒ¼ã‚¹ã‚¿ãƒ¼**ã‚’ãƒ›ãƒƒãƒˆãƒãƒ¼ä¸­å¤®ã«é…å¸ƒ
- å³ã‚¯ãƒªãƒƒã‚¯ã§ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆé¸æŠGUIã‚’é–‹ã
- Fire / Ice / Wind / Earth ã‹ã‚‰é¸æŠ
- æœªé¸æŠè€…ã«ã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒ¼ã§ç¹°ã‚Šè¿”ã—å‚¬ä¿ƒ
- æ™‚é–“åˆ‡ã‚Œã®å ´åˆã¯ãƒ©ãƒ³ãƒ€ãƒ 

#### 4. ã‚­ãƒ³ã‚°æŠ•ç¥¨
- Titleè¡¨ç¤ºï¼šã€ŒğŸ‘‘ ã‚­ãƒ³ã‚°æŠ•ç¥¨ã‚¿ã‚¤ãƒ  ğŸ‘‘ã€
- ãƒãƒ£ãƒƒãƒˆã§ **`!king`** ã¨ç™ºè¨€ã§ç«‹å€™è£œ
- ç«‹å€™è£œè€…ãŒã„ã‚Œã°ãã®ä¸­ã‹ã‚‰é¸å‡º
- ã„ãªã‘ã‚Œã°ãƒ©ãƒ³ãƒ€ãƒ é¸å‡º

#### 5. ãƒ†ãƒ¬ãƒãƒ¼ãƒˆ & åˆæœŸè£…å‚™
- å„ãƒãƒ¼ãƒ ã®ã‚¹ãƒãƒ¼ãƒ³åœ°ç‚¹ã¸ãƒ†ãƒ¬ãƒãƒ¼ãƒˆ
- åˆæœŸè£…å‚™é…å¸ƒï¼š
  - çš®ãƒ•ãƒ«ã‚»ãƒƒãƒˆï¼ˆãƒãƒ¼ãƒ ã‚«ãƒ©ãƒ¼ï¼‰
  - æœ¨ã®å‰£
  - ã‚¹ãƒ†ãƒ¼ã‚­ 16å€‹

---

## Phase 3: RUNNING (æœ¬æˆ¦)

### é–‹å§‹æ™‚ã®å‡¦ç†
1. **NPCã‚¹ãƒãƒ¼ãƒ³** - å„ãƒãƒ¼ãƒ ã®æ‹ ç‚¹ã«ã‚·ãƒ§ãƒƒãƒ—/éŠ€è¡ŒNPC
2. **ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰é–‹å§‹** - ã‚µã‚¤ãƒ‰ãƒãƒ¼ã€ãƒœã‚¹ãƒãƒ¼è¡¨ç¤º
3. **ã‚³ã‚¢ç›£è¦–é–‹å§‹** - æ¥è¿‘è­¦å‘Šã‚·ã‚¹ãƒ†ãƒ 
4. **Shardã‚¹ãƒãƒ¼ãƒ³é–‹å§‹** - 10ç§’ã”ã¨
5. **ã‚­ãƒ³ã‚°ã‚ªãƒ¼ãƒ©é–‹å§‹** - 1ç§’ã”ã¨å‘¨å›²ã« Speed I

### ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—

#### 3ç§’ã”ã¨: ã‚¨ãƒªã‚¢å é ˜åˆ¤å®š
```java
// Bã‚¨ãƒªã‚¢å†…ã®äººæ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
int blueCount = areaB.getPlayersInside(Team.BLUE);
int redCount = areaB.getPlayersInside(Team.RED);

if (blueCount > redCount) {
    addScore(Team.BLUE, 2);
    // è©²å½“ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒ¼: "Bã‚¨ãƒªã‚¢åˆ¶åœ§ä¸­ï¼ +2pt"
} else if (redCount > blueCount) {
    addScore(Team.RED, 2);
}
```

#### 10ç§’ã”ã¨: Shardã‚¹ãƒãƒ¼ãƒ³
```java
// å„ã‚¨ãƒªã‚¢ã«Shardã‚’ãƒ‰ãƒ­ãƒƒãƒ—
shardManager.spawnShard(areaB.getSpawnPoint(), amount);
// å¤§è¦æ¨¡ãƒ¢ãƒ¼ãƒ‰ãªã‚‰A/Cã«ã‚‚
```

#### 1ç§’ã”ã¨: æ‹ ç‚¹å¸°é‚„ãƒã‚§ãƒƒã‚¯
```java
// ã‚¹ãƒãƒ¼ãƒ³åœ°ç‚¹ã‹ã‚‰10ãƒ–ãƒ­ãƒƒã‚¯ä»¥å†…ã§è‡ªå‹•è²¯é‡‘
if (distance <= 10) {
    if (shardCarrying > 0) {
        shardManager.onReturnToBase(klPlayer);
    }
    if (luminaCarrying > 0) {
        luminaManager.onReturnToBase(klPlayer);
    }
}
```

#### 2ç§’ã”ã¨: ã‚³ã‚¢æ¥è¿‘ãƒã‚§ãƒƒã‚¯
```java
// æ•µãŒã‚³ã‚¢ã‹ã‚‰10ãƒ–ãƒ­ãƒƒã‚¯ä»¥å†…ã«å…¥ã£ãŸã‚‰è­¦å‘Š
if (distance <= 10) {
    warnTeam(coreTeam);
    // ãƒœã‚¹ãƒãƒ¼: "âš  ã‚³ã‚¢ã«æ•µãŒæ¥è¿‘ä¸­ï¼"
    // ã‚µã‚¦ãƒ³ãƒ‰å†ç”Ÿ
}
```

### ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†

#### ã‚­ãƒ«ç™ºç”Ÿæ™‚
```java
// ãƒã‚¤ãƒ³ãƒˆåŠ ç®—
if (victim.isKing()) {
    addScore(killer.getTeam(), 20);      // ã‚­ãƒ³ã‚°ã‚­ãƒ«
    addScore(victim.getTeam(), -50);     // ãƒšãƒŠãƒ«ãƒ†ã‚£
    // æ•µå…¨å“¡ã«Strength 15ç§’
    // Shard 5å€‹ãƒ‰ãƒ­ãƒƒãƒ—
    // æ–°ã‚­ãƒ³ã‚°é¸å‡º
} else {
    addScore(killer.getTeam(), 4);       // é€šå¸¸ã‚­ãƒ«
}

// Luminaä»˜ä¸ï¼ˆæ‰€æŒä¸­ã«åŠ ç®—ï¼‰
killer.addLuminaCarrying(2);

// SPã‚²ãƒ¼ã‚¸åŠ ç®—ï¼ˆãƒ’ãƒƒãƒˆæ•°ã§ã‚«ã‚¦ãƒ³ãƒˆæ¸ˆã¿ï¼‰
```

#### Shardæ‹¾å¾—æ™‚
```java
klPlayer.addShardCarrying(amount);
// ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒ¼: "â—ˆ+1 (æ‰€æŒ: 3)"
```

#### Luminaæ‹¾å¾—æ™‚ï¼ˆæ•µãŒãƒ‰ãƒ­ãƒƒãƒ—ã—ãŸã‚‚ã®ï¼‰
```java
klPlayer.addLuminaCarrying(amount);
// ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒ¼: "âœ¦+1 (æ‰€æŒ: 5)"
```

#### æ­»äº¡æ™‚
```java
// æ‰€æŒä¸­ã®é€šè²¨ã‚’ãƒ‰ãƒ­ãƒƒãƒ—
shardManager.dropPlayerShards(klPlayer, deathLocation);
luminaManager.dropPlayerLumina(klPlayer, deathLocation);

// ãƒªã‚¹ãƒãƒ¼ãƒ³å¯èƒ½ã‹ç¢ºèª
if (klPlayer.canRespawn()) {
    // ãƒªã‚¹ãƒãƒ¼ãƒ³ â†’ è£…å‚™å†ä»˜ä¸
} else {
    // è¦³æˆ¦ãƒ¢ãƒ¼ãƒ‰ã¸
}
```

#### ã‚³ã‚¢ç ´å£Šæ™‚
```java
// ãƒã‚¤ãƒ³ãƒˆåŠ ç®—
addScore(destroyer.getTeam(), 100);

// Shardãƒ‰ãƒ­ãƒƒãƒ—
shardManager.dropCoreShards(coreLocation);  // 20å€‹

// å…¨å“¡ã«Titleé€šçŸ¥
sendTitle("ğŸ’¥ ã‚³ã‚¢ç ´å£Šï¼", "â—‹â—‹ã®ã‚³ã‚¢ãŒç ´å£Šã•ã‚Œã¾ã—ãŸï¼");

// 5ç§’å¾Œã«å†ç”Ÿæˆ
scheduleRegeneration(coreLocation, team);
```

### 500ptåˆ°é”æ™‚
```java
Team loser = getLosingTeam();

// æ•—åŒ—ãƒãƒ¼ãƒ ã®ãƒªã‚¹ãƒãƒ¼ãƒ³ç„¡åŠ¹åŒ–
for (KLPlayer klp : getTeamPlayers(loser)) {
    klp.setCanRespawn(false);
}

// å…¨å“¡ã«Titleé€šçŸ¥
sendTitle("âš  ãƒªã‚¹ãƒãƒ¼ãƒ³ç„¡åŠ¹åŒ–ï¼", loser + "ãƒãƒ¼ãƒ ã¯ãƒªã‚¹ãƒãƒ¼ãƒ³ã§ããªããªã‚Šã¾ã—ãŸï¼");
```

---

## Phase 4: ENDING (çµ‚äº†)

### ãƒˆãƒªã‚¬ãƒ¼
- ãƒªã‚¹ãƒãƒ¼ãƒ³ç„¡åŠ¹åŒ–å¾Œã€ç‰‡æ–¹ã®ãƒãƒ¼ãƒ ãŒå…¨æ»…

### å‡¦ç†

#### 1. åœæ­¢å‡¦ç†
- ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰åœæ­¢
- ã‚³ã‚¢ç›£è¦–åœæ­¢
- Shardã‚¹ãƒãƒ¼ãƒ³åœæ­¢
- NPCå‰Šé™¤

#### 2. çµæœç™ºè¡¨
å‹åˆ©ãƒãƒ¼ãƒ ã«ã¯Titleè¡¨ç¤ºï¼š
```
ğŸ‰ å‹åˆ©ï¼ ğŸ‰
ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼
```

æ•—åŒ—ãƒãƒ¼ãƒ ã«ã¯ï¼š
```
æ•—åŒ—...
ã¾ãŸæ¬¡å›é ‘å¼µã‚Šã¾ã—ã‚‡ã†
```

ãƒãƒ£ãƒƒãƒˆã«è©³ç´°ï¼š
```
=====================================
      BLUE TEAM WINS!
=====================================
  Final Score: BLUE 523 - RED 500
=====================================
```

#### 3. çµ±è¨ˆä¿å­˜
```java
for (KLPlayer klp : getAllPlayers()) {
    statsDatabase.recordGame(
        klp.getUuid(),
        klp.getTeam() == winnerTeam,
        klp.getKillsThisGame(),
        klp.getDeathsThisGame()
    );
}
```

#### 4. ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- å…¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ãƒ­ãƒ“ãƒ¼ã¸ãƒ†ãƒ¬ãƒãƒ¼ãƒˆ
- ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªã‚¯ãƒªã‚¢
- ãƒãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœã‚¯ãƒªã‚¢
- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒªã‚»ãƒƒãƒˆ
- GameState â†’ WAITING
